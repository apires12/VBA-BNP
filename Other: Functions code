Option Private Module

Sub TRPOLESHOW()

TRPOLE.Show

End Sub

Sub DATEFORMAT()

DATEFORMATFRM.Show

End Sub

Sub InputDot_Paragraph()

    Selection.TypeParagraph
    Selection.TypeText TEXT:="."
    Selection.TypeParagraph

End Sub

Sub FormatDates(Date1, Y_N, DateE, DateF)

Dim Date1Fix As Variant
Dim Date2 As Variant
Dim MyDay As Variant
Dim MyYear As Variant

Dim MyMonthE As String
Dim MyMonthF As String
Dim Ultima As String
Dim UltimaF As String

'Split the date in 3: dd/mm/yyyy
Date1Fix = Split(Date1, "/")

'Creates a serial date matrix yyyy/mm/dd
Date2 = DateSerial(Date1Fix(2), Date1Fix(1), Date1Fix(0))
    
If Month(Date2) = 1 Then
    MyMonthE = "January"
    MyMonthF = "janvier"
ElseIf Month(Date2) = 2 Then
    MyMonthE = "February"
    MyMonthF = "février"
ElseIf Month(Date2) = 3 Then
    MyMonthE = "March"
    MyMonthF = "mars"
ElseIf Month(Date2) = 4 Then
    MyMonthE = "April"
    MyMonthF = "avril"
ElseIf Month(Date2) = 5 Then
    MyMonthE = "May"
    MyMonthF = "mai"
ElseIf Month(Date2) = 6 Then
    MyMonthE = "June"
    MyMonthF = "juin"
ElseIf Month(Date2) = 7 Then
    MyMonthE = "July"
    MyMonthF = "juillet"
ElseIf Month(Date2) = 8 Then
    MyMonthE = "August"
    MyMonthF = "août"
ElseIf Month(Date2) = 9 Then
    MyMonthE = "September"
    MyMonthF = "septembre"
ElseIf Month(Date2) = 10 Then
    MyMonthE = "October"
    MyMonthF = "octobre"
ElseIf Month(Date2) = 11 Then
    MyMonthE = "November"
    MyMonthF = "novembre"
ElseIf Month(Date2) = 12 Then
    MyMonthE = "December"
    MyMonthF = "décembre"
End If

MyDay = Format(Day(Date2))
MyYear = Format(Year(Date2))

If Day(Date2) = 1 Then
    UltimaF = "er"
End If

If Y_N = True Then
    
    Select Case Day(Date2)
    
        Case Is = 1, Is = 21, Is = 31
            Ultima = "st"
        Case Is = 2, Is = 22
            Ultima = "nd"
        Case Is = 3, Is = 23
            Ultima = "th"
    
    End Select
    
    DateE = MyMonthE & " " & MyDay & Ultima & ", " & MyYear
    
Else

    DateE = MyDay & " " & MyMonthE & " " & MyYear

End If

DateF = MyDay & UltimaF & " " & MyMonthF & " " & MyYear

Set Date1Fix = Nothing
Set Date2 = Nothing
Set MyDay = Nothing
Set MyYear = Nothing

MyMonthE = ""
MyMonthF1 = ""
Ultima = ""
UltimaF = ""


End Sub

Sub Find_French_Update(FrenchPlace)

With Selection

    .WholeStory
    .HomeKey wdStory
    .Find.Execute FrenchPlace

    'If there is no disclaimer, the update in french is
    'to be done at the end of the text
    If Selection <> FrenchPlace Then
        
        .EndKey unit:=wdStory
        
    Else
    
        If FrenchPlace = "Mise à jour" Then

            .MoveDown unit:=wdParagraph, Count:=1
            .EndKey unit:=wdLine
            .TypeParagraph
        
        ElseIf FrenchPlace = "Message d'origine" Then
            
            .MoveUp unit:=wdParagraph, Count:=1
            '.EndKey unit:=wdLine
            '.TypeParagraph
            
        End If

    End If

End With
    

End Sub

sub

Sub NumbersFormat(Number, Y_N, NumberE, NumberF)

Dim NumberSplit() As String
Dim varright As String
Dim varleft As String
Dim counter As Integer
Dim nr As Integer: nr = 3
Dim i As Integer
Dim counter2 As Integer


Number = Replace(Number, ",", ".")
NumberSplit() = Split(Number, ".")


Select Case Len(NumberSplit(0))

    Case Is <= 3
        
        NumberE = Number
        NumberF = Replace(Number, ".", ",")

    Case Else

        counter = Round((Len(NumberSplit(0)) / 3) - 0.51)

        NumberE = NumberSplit(0)

        counter2 = 0
    
        For i = 1 To counter

            varright = Right(NumberE, nr)

            varleft = Left(NumberE, Len(NumberSplit(0)) + counter2 - nr)
        
            NumberE = varleft & "," & varright

            nr = nr + 4
        
            counter2 = counter2 + 1
        
        Next i
    
    NumberE = varleft & "," & varright & "." & NumberSplit(1)
    
End Select

If Y_N = False Then

    NumberF = Replace(NumberE, ",", "@")
    NumberF = Replace(NumberF, ".", ",")
    NumberF = Replace(NumberE, "@", ",")

End If

End Sub

